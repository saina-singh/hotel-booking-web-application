{% extends 'base.html' %}

{% block head %}
<title>Admin Dashboard</title>
{% endblock %}

{% block body %}


<div class="container my-4">

  <div class="admin-shell">

    <!-- SIDEBAR -->
    <aside class="admin-sidebar">
      <div class="admin-brand">World Hotels</div>

      <nav class="admin-nav">
        <a class="active" href="{{ url_for('admin_dashboard') }}">
          <div class="admin-icon">üè†</div>
          <div>
            <div class="fw-semibold">Dashboard</div>
          </div>
        </a>

        <a href="#">
          <div class="admin-icon">üìÖ</div>
          <div class="fw-semibold">Reservation</div>
        </a>

        <a href="#">
          <div class="admin-icon">üõèÔ∏è</div>
          <div class="fw-semibold">Rooms</div>
        </a>

        <a href="#">
          <div class="admin-icon">üßë‚Äçüíº</div>
          <div class="fw-semibold">Staffs</div>
        </a>

        <a href="#">
          <div class="admin-icon">üìä</div>
          <div class="fw-semibold">Analytics</div>
        </a>

        <a href="#">
          <div class="admin-icon">üßæ</div>
          <div class="fw-semibold">Reports</div>
        </a>

        <a href="#">
          <div class="admin-icon">‚≠ê</div>
          <div class="fw-semibold">Reviews</div>
        </a>

        <a href="#">
          <div class="admin-icon">‚öôÔ∏è</div>
          <div class="fw-semibold">Settings</div>
        </a>
      </nav>
    </aside>

    <!-- MAIN -->
    <main class="admin-main">

      <!-- TOPBAR -->
      <div class="admin-topbar">
        <div>
          <h2 class="fw-bold mb-0">Admin Dashboard</h2>
          <div class="text-muted small">Welcome, {{ session.get('email') }}</div>
        </div>

        <div class="d-flex align-items-center gap-3 flex-wrap justify-content-end" style="flex:1;">
          <div class="admin-search">
            <span class="text-muted">üîé</span>
            <input type="text" placeholder="Search cities, rooms, etc..." />
          </div>

          <div class="top-icons">
            <button class="icon-btn" type="button" title="Messages">üí¨</button>
            <button class="icon-btn" type="button" title="Notifications">üîî</button>
          </div>

          <div class="admin-profile">
            <div class="admin-avatar">
              {{ (session.get('email','A'))[0].upper() }}
            </div>
            <div class="d-none d-md-block">
              <div class="fw-bold">Saina Singh</div>
              <div class="text-muted small">Admin</div>
            </div>
          </div>
        </div>
      </div>

      <!-- KPI ROW -->
      <div class="row g-3 mb-4">
        <div class="col-md-3">
          <div class="card kpi-card">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <div class="kpi-label">Total Revenue</div>
                <div class="text-muted">‚ãÆ</div>
              </div>
              <div class="kpi-value">¬£32,800</div>
              <div class="kpi-sub">
                <span class="pill green">‚Üó 3.17%</span>
                <span>from last week</span>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card kpi-card">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <div class="kpi-label">New Bookings</div>
                <div class="text-muted">‚ãÆ</div>
              </div>
              <div class="kpi-value">109</div>
              <div class="kpi-sub">
                <span class="pill green">‚Üó 2.28%</span>
                <span>from last week</span>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card kpi-card">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <div class="kpi-label">Check-in</div>
                <div class="text-muted">‚ãÆ</div>
              </div>
              <div class="kpi-value">89</div>
              <div class="kpi-sub">
                <span class="pill red">‚Üò 2.28%</span>
                <span>from last week</span>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card kpi-card">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <div class="kpi-label">Check-out</div>
                <div class="text-muted">‚ãÆ</div>
              </div>
              <div class="kpi-value">17</div>
              <div class="kpi-sub">
                <span class="pill green">‚Üó 0.97%</span>
                <span>from last week</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- MIDDLE ROW -->
      <div class="row g-3 mb-4">
        <div class="col-lg-4">
          <div class="card panel-card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="panel-title">Guests</div>
                <select class="form-select form-select-sm" style="max-width: 140px;">
                  <option>This Week</option>
                  <option>Last Week</option>
                  <option>This Month</option>
                </select>
              </div>
              <div class="chart-placeholder">Line chart placeholder</div>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card panel-card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="panel-title">Revenue</div>
                <select class="form-select form-select-sm" style="max-width: 160px;">
                  <option>Last 8 months</option>
                  <option>Last 6 months</option>
                  <option>This Year</option>
                </select>
              </div>
              <div class="chart-placeholder">Bar chart placeholder</div>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card panel-card">
            <div class="card-body">
              <div class="panel-title mb-2">Overall Ratings</div>

              <div class="d-flex align-items-center gap-3 mb-3">
                <div class="border rounded-3 px-3 py-2 fw-bold"
                  style="font-size: 24px; min-width: 80px; text-align:center;">
                  4.9
                </div>
                <div>
                  <div class="fw-bold">Excellent</div>
                  <div class="text-muted small">1,024 verified users</div>
                </div>
              </div>

              {% set rows = [
              ('Cleanliness', 48),
              ('Facilities', 49),
              ('Location', 47),
              ('Service', 48),
              ('Value', 49)
              ] %}

              {% for label, pct in rows %}
              <div class="mb-3">
                <div class="d-flex justify-content-between small mb-1">
                  <span class="text-muted">{{ label }}</span>
                  <span class="text-muted">{{ (pct/10)|round(1) }}</span>
                </div>
                <div class="ratings-bar">
                  <div style="width: {{ pct }}%;"></div>
                </div>
              </div>
              {% endfor %}

            </div>
          </div>
        </div>
      </div>

      <!-- BOTTOM ROW -->
      <div class="row g-3">
        <div class="col-lg-8">
          <div class="card panel-card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="panel-title">Users</div>
                <span class="text-muted small">Total users: <b>{{ total_users }}</b></span>
              </div>

              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="table-light">
                    <tr>
                      <th style="width:80px;">ID</th>
                      <th>Name</th>
                      <th>Email</th>
                      <th style="width:130px;">Role</th>
                      <th style="width:120px;">Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for u in users %}
                    <tr>
                      <td>{{ u.user_id }}</td>
                      <td class="fw-semibold">{{ u.first_name }} {{ u.last_name }}</td>
                      <td>{{ u.email }}</td>
                      <td>
                        <span class="badge {% if u.role == 'ADMIN' %}bg-dark{% else %}bg-secondary{% endif %}">
                          {{ u.role }}
                        </span>
                      </td>
                      <td>
                        {% if u.is_active == 1 %}
                        <span class="badge bg-success">Active</span>
                        {% else %}
                        <span class="badge bg-warning text-dark">Inactive</span>
                        {% endif %}
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>

            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card panel-card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <div class="panel-title">Room Occupancy</div>
                  <div class="text-muted small">Quick snapshot</div>
                </div>
                <div class="text-muted">‚ãÆ</div>
              </div>

              <div class="d-flex align-items-center gap-3 mt-3">
                <div style="font-size: 34px;">üõãÔ∏è</div>
                <div>
                  <div class="fw-bold" style="font-size: 26px;">90</div>
                  <div class="text-muted small">Total Rooms</div>
                </div>
              </div>

              <div class="mt-3 small">
                <div class="d-flex justify-content-between py-2 border-bottom">
                  <span>üîµ 48 occupied</span>
                  <span class="text-muted">today</span>
                </div>
                <div class="d-flex justify-content-between py-2 border-bottom">
                  <span>üü£ 13 reserved</span>
                  <span class="text-muted">upcoming</span>
                </div>
                <div class="d-flex justify-content-between py-2 border-bottom">
                  <span>üü¢ 20 available</span>
                  <span class="text-muted">ready</span>
                </div>
                <div class="d-flex justify-content-between py-2">
                  <span>‚ö´ 9 not ready</span>
                  <span class="text-muted">maintenance</span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>

{% endblock %}