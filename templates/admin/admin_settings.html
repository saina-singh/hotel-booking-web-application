{% extends "base.html" %}
{% block head %}
<title>Admin • Settings</title>
{% endblock %}

{% block body %}
<div class="container admin-page py-4">
  <div class="admin-shell">
    <aside class="admin-sidebar">
      <div class="admin-brand">Admin Dashboard</div>
      <nav class="admin-nav">
        <a href="{{ url_for('admin_dashboard') }}" class="{% if endpoint == 'admin_dashboard' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-speedometer2"></i></div>
          <div class="fw-semibold">Dashboard</div>
        </a>
        <a href="{{ url_for('admin_reservations') }}"
          class="{% if endpoint == 'admin_reservations' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-calendar-check"></i></div>
          <div class="fw-semibold">Reservations</div>
        </a>
        <a href="{{ url_for('admin_rooms') }}" class="{% if endpoint == 'admin_rooms' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-door-open"></i></div>
          <div class="fw-semibold">Rooms</div>
        </a>
        <a href="{{ url_for('admin_staffs') }}" class="{% if endpoint == 'admin_staffs' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-people"></i></div>
          <div class="fw-semibold">Staffs</div>
        </a>
        <a href="{{ url_for('admin_analytics') }}" class="{% if endpoint == 'admin_analytics' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-bar-chart"></i></div>
          <div class="fw-semibold">Analytics</div>
        </a>
        <a href="{{ url_for('admin_reports') }}" class="{% if endpoint == 'admin_reports' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-file-earmark-text"></i></div>
          <div class="fw-semibold">Reports</div>
        </a>
        <a href="{{ url_for('admin_settings') }}" class="{% if endpoint == 'admin_settings' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-gear"></i></div>
          <div class="fw-semibold">Settings</div>
        </a>
        <a href="{{ url_for('admin_users') }}" class="{% if endpoint == 'admin_users' %}active{% endif %}">
          <div class="admin-icon"><i class="bi bi-person-badge"></i></div>
          <div class="fw-semibold">Users</div>
        </a>
      </nav>
    </aside>

    <main class="admin-main">
      {% include "admin/_admin_topbar.html" with context %}

      <div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-3">
        <div>
          <h3 class="fw-bold mb-1">Settings</h3>
          <div class="text-muted">System preferences and admin controls.</div>
        </div>
      </div>

      <div class="row g-3">

        <!-- GENERAL (SAVES) -->
        <div class="col-lg-6">
          <div class="card shadow-sm">
            <div class="card-body p-4">
              <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="fw-bold">General</div>
                <span class="badge bg-light text-dark border">
                  <i class="bi bi-sliders me-1"></i>Site config
                </span>
              </div>

              <form method="POST" class="mt-3">
                <div class="mb-3">
                  <label class="form-label fw-semibold">Site name</label>
                  <input class="form-control" name="site_name" value="{{ settings.site_name }}" maxlength="60" required>
                  <div class="text-muted small mt-1">Shown in the navbar and receipts.</div>
                </div>

                <div class="mb-3">
                  <label class="form-label fw-semibold">Base currency</label>
                  <select class="form-select" name="base_currency" required>
                    <option value="GBP" {% if settings.base_currency=='GBP' %}selected{% endif %}>GBP</option>
                    <option value="USD" {% if settings.base_currency=='USD' %}selected{% endif %}>USD</option>
                    <option value="EUR" {% if settings.base_currency=='EUR' %}selected{% endif %}>EUR</option>
                    <option value="NRS" {% if settings.base_currency=='NRS' %}selected{% endif %}>NRS</option>
                  </select>
                  <div class="text-muted small mt-1">
                    Used as the system’s default currency for reports (your booking totals can still be converted).
                  </div>
                </div>

                <div class="d-flex gap-2">
                  <button class="btn btn-dark">
                    <i class="bi bi-check2-circle me-1"></i>Save settings
                  </button>
                  <a class="btn btn-outline-dark" href="{{ url_for('admin_settings') }}">
                    Reset
                  </a>
                </div>
              </form>

            </div>
          </div>
        </div>

        <!-- SECURITY (INFORMATIONAL) -->
        <div class="col-lg-6">
          <div class="card shadow-sm">
            <div class="card-body p-4">
              <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="fw-bold">Security</div>
                <span class="badge bg-light text-dark border">
                  <i class="bi bi-shield-lock me-1"></i>Controls
                </span>
              </div>

              <div class="d-flex justify-content-between align-items-start gap-3 border-bottom pb-3 mb-3">
                <div>
                  <div class="fw-semibold">Require activation</div>
                  <div class="text-muted small">Users must activate via email before login.</div>
                </div>
                <span class="badge bg-success mt-1">Enabled</span>
              </div>

              <div class="d-flex justify-content-between align-items-start gap-3">
                <div>
                  <div class="fw-semibold">Cookie preferences</div>
                  <div class="text-muted small">Users manage cookies from their account.</div>
                </div>
                <a class="btn btn-outline-dark btn-sm" href="{{ url_for('cookies_settings') }}">
                  View
                </a>
              </div>

              <hr class="my-4">

              <div class="text-muted small">
                Tip: Settings are saved in the <span class="fw-semibold">site_settings</span> table.
              </div>

            </div>
          </div>
        </div>

      </div>

    </main>
  </div>
</div>
{% endblock %}